---
import { sanityClient } from "sanity:client";
type Article = {
  title: string;
  slug: string;
  category: string;
};

const articlesData = await sanityClient.fetch<Article[]>(`
  *[_type == 'article' && defined(slug) && defined(category)] | order(publishDate desc){
    title,
    "slug": slug.current,
    category
}[0...4]
`);
---

<div
  class="col-start-1 col-span-12 mb-8 p-4 sm:p-0 sm:col-start-2 sm:col-span-10 lg:mb-40"
>
  <hgroup
    class="flex justify-between items-baseline text-neutral-900 mb-8 md:mb-20"
  >
    <h2 class="font-title font-bold text-3xl md:text-5xl">Collection</h2>
    <div class="flex items-center gap-2">
      <a
        href="/collection/all/1"
        class="font-title text-lg md:text-2xl font-thin"
        data-astro-prefetch>View more&nbsp;&nbsp;â†’</a
      >
    </div>
  </hgroup>
  <ul class="space-y-8 md:space-y-10">
    {
      articlesData.map((article) => (
        <li>
          <a href={`/collection/detail/${article.slug}`} class="space-y-2">
            <h3
              title={article.title}
              class="line-clamp-2 font-title font-bold text-2xl/8 md:text-3xl/12 text-neutral-900"
            >
              {article.title}
            </h3>
            <p class="text-neutral-900 opacity-50 capitalize">
              {article.category.split("-").join(" ")}
            </p>
          </a>
        </li>
      ))
    }
  </ul>
</div>
